<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>P2P Token Trade</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Correct ethers.js -->
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>

    <style>
        body {
            background-color: #121212;
            color: #ffffff;
        }
        .card {
            background-color: #1f1f1f;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        input {
            margin-bottom: 10px;
        }
    </style>
</head>

<body class="container py-5">
    <h1 class="text-center mb-5">ðŸš€ P2P Token Trading</h1>

    <div class="d-flex justify-content-center mb-4">
        <button onclick="connectWallet()" class="btn btn-primary">Connect Wallet</button>
    </div>

    <div class="row">
        <!-- Create Offer -->
        <div class="col-md-6">
            <div class="card">
                <h3>Create Offer</h3>
                <input id="tokenOffered" class="form-control" placeholder="Token Offered Address">
                <input id="amountOffered" class="form-control" placeholder="Amount Offered">
                <input id="tokenRequested" class="form-control" placeholder="Token Requested Address">
                <input id="amountRequested" class="form-control" placeholder="Amount Requested">
                <button onclick="createOffer()" class="btn btn-success w-100 mt-2">Create Offer</button>
            </div>
        </div>

        <!-- Accept Offer -->
        <div class="col-md-6">
            <div class="card">
                <h3>Accept Offer</h3>
                <input id="offerIdAccept" class="form-control" placeholder="Offer ID">
                <button onclick="acceptOffer()" class="btn btn-warning w-100 mt-2">Accept Offer</button>
            </div>
        </div>
    </div>

    <!-- Expire Offer -->
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <div class="card">
                <h3>Expire Offer</h3>
                <input id="offerIdExpire" class="form-control" placeholder="Offer ID">
                <button onclick="expireOffer()" class="btn btn-danger w-100 mt-2">Expire Offer</button>
            </div>
        </div>
    </div>

    <!-- Ethers + Web3 -->
    <script>
        let provider, signer, contract;

        const CONTRACT_ADDRESS = "0x557Bb8f27FEe8186B5594abED96495255fE634e8";
        const CONTRACT_ABI = [ /* paste your ABI here */ ];

        async function connectWallet() {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
            alert("Wallet Connected");
        }

        async function createOffer() {
            const tokenOffered = document.getElementById('tokenOffered').value;
            const amountOffered = ethers.utils.parseUnits(document.getElementById('amountOffered').value, 18);
            const tokenRequested = document.getElementById('tokenRequested').value;
            const amountRequested = ethers.utils.parseUnits(document.getElementById('amountRequested').value, 18);

            const tx = await contract.createOffer(tokenOffered, amountOffered, tokenRequested, amountRequested);
            await tx.wait();
            alert("Offer Created!");
        }

        async function acceptOffer() {
            const offerId = document.getElementById('offerIdAccept').value;
            const tx = await contract.acceptOffer(offerId);
            await tx.wait();
            alert("Offer Accepted!");
        }

        async function expireOffer() {
            const offerId = document.getElementById('offerIdExpire').value;
            const tx = await contract.expireOffer(offerId);
            await tx.wait();
            alert("Offer Expired!");
        }
    </script>
</body>
</html>
